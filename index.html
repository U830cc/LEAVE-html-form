<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0">
    <title>Contact Us</title>
    <link rel="shortcut icon" href="images/index.ico" type="image/x-icon">

    <!-- CSS: Fontawesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- CSS: Bootstrap v-5.3 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">


<body> 
             <!-- space -->
                <div class="py-lg-5 py-md-4 py-sm-3 py-2"></div>
                <div class="row justify-content-center pt-5">
                    <div class="col-lg-7 col-md-10">
                        <h3 class="fw-normal text-center mb-5 border-bottom pb-2">แบบฟอร์มแจ้งลา</h3>

                        <form class="form_overlay" method="POST" accept-charset="UTF-8" autocomplete="off" name="contact"> 
                            <div class="row g-4">
                                <div class="col-lg-6">
                                    <div class="input_overlay">
                                        <label for="fname" class="lable">ชื่อ-สกุล</label>
                                        <input type="text" name="first_name" class="form-control" required autocomplete="off">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="input_overlay">
                                        <label for="lname" class="lable">เลขประจำตัวนักเรียน</label>
                                        <input type="text" name="last_name" class="form-control" required autocomplete="off">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="input_overlay">
                                        <label for="email" class="lable">ลาตั้งแต่</label>
                                        <input type="text" name="email" class="form-control" required autocomplete="off">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="input_overlay">
                                        <label for="phone" class="lable">จนถึง</label>
                                        <input type="text" name="phone" class="form-control" required autocomplete="off">
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="input_overlay">
                                        <label for="subject" class="lable">ประเภทการลา (ลากิจ,ลาป่วย,ลากิจครึ่งวันเช้า,ลากิจครึ่งวันบ่าย,ลาป่วยครึ่งวันเช้า,ลาป่วยครึ่งวันบ่าย)</label>
                                        <input type="text" name="subject" class="form-control" required autocomplete="off">
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="input_overlay textarea">
                                        <label for="desc" class="lable">เหตุผลการลา</label>
                                        <textarea name="description" cols="30" rows="4" class="form-control" required autocomplete="off"></textarea>
                                    </div>
                                </div>

                                <div class="col-12 text-end">
                                <button type="submit" class="btn btn-primary mt-3">ส่ง</button>
                                </div>
                                <p id="demo"></p>
                            </div>

                        </form>
                    </div>
                </div>


    </main>




   <script>
            const scriptURL = 'https://script.google.com/macros/s/AKfycbxtHBpK-wy0mjG415uVzCEgW4YvrguTmIlvsm2c5IXBnDm6fsuWEpsnMI1QbKbXJI9myA/exec'
            const form = document.forms['contact']

            form.addEventListener('submit', e => {
              e.preventDefault()
              fetch(scriptURL, { method: 'POST', body: new FormData(form)})
                .then(response => document.getElementById("demo").innerHTML = "<div class='alert alert-primary' role='alert'><b>Thank You for providing the details, We shall get back to you shortly !</b></div>",contact.reset())
                .catch(error => console.error('Error!', error.message))
            })
    </script>


 </body>
 </html>